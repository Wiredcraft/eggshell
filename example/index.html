<!DOCTYPE html>
<html>
<head>
  <title></title>
</head>
  <link rel="stylesheet" href="bower_components/CodeMirror/lib/codemirror.css">
  <script src="bower_components/CodeMirror/lib/codemirror.js"></script>
  <script src="bower_components/CodeMirror/mode/css/css.js"></script>
  <script src="bower_components/CodeMirror/mode/xml/xml.js"></script>
<link rel="stylesheet" type="text/css" href="dist/test.css">
<body class="modal">

<div class="row render">
  <h3>Code</h3>
  <div class="col-1-3"><label>HTML</label>
  <textarea class="html">&lt;pre&gt;&lt;code&gt;
  var pi = 3.1415;
&lt;/code&gt;&lt;/pre&gt;</textarea></div>
  <div class="col-1-3"><label>CSS</label>
    <textarea class="css">/* no css */</textarea>
  </div>
  <div class="col-1-3"><label>Rendering</label><div class="rendering shadow-root"></div></div>
</div>




<div class="row render">
  <h3>Button</h3>
  <div class="col-1-3"><label>HTML</label>
  <textarea class="html">&lt;button class=&quot;button&quot;&gt;
    Normal Button
&lt;/button&gt;
&lt;a class=&quot;button&quot;&gt;
    Link Button
&lt;/a&gt;</textarea></div>
  <div class="col-1-3"><label>CSS</label>
  <textarea class="css">.button {
  margin: 20px;
}</textarea></div>
  <div class="col-1-3"><label>Rendering</label><div class="rendering shadow-root"></div></div>
</div>



<div class="row render">
  <h3>Notification</h3>

  <div class="col-1-3">
   <label>HTML</label>
<textarea class="html">&lt;div class=&quot;notification info&quot;&gt;
This is an info notification 
&lt;/div&gt;
&lt;div class=&quot;notification error&quot;&gt;
This is an error notification 
&lt;/div&gt;
</textarea>
  </div>
  <div class="col-1-3"><label>CSS</label>
   <textarea class="css">.notification {
  width: 80%;
  margin-top: 1.4em;
  margin-left: auto;
  margin-right: auto;
}</textarea>
  </div>
  <div class="col-1-3">
   <label>Rendering</label>
   <div class="rendering shadow-root"></div>
  </div>
</div>




<div class="row render">
<h3>Loading</h3>
<div class="col-1-3"><label>HTML</label>
<textarea class="html">
&lt;span class=&quot;loading&quot;&gt;&lt;/span&gt;
</textarea>
  </div>
  <div class="col-1-3">
   <label>CSS</label>
  <textarea class="css">.loading {
  margin: 13em;
  padding-bottom: 67px;
}</textarea>
  </div>
  <div class="col-1-3">
   <label>Rendering</label>
   <div class="rendering shadow-root"></div>
  </div>
</div>




<div class="row render">
  <h3>Pulse</h3>
  <div class="col-1-3">
   <label>HTML</label>
   <textarea class="html">
&lt;span class=&quot;pulse-mixin&quot;&gt;this text is pulse&lt;/span&gt;
   </textarea>
  </div>
  <div class="col-1-3">
   <label>CSS</label>
   <textarea class="css">
.pulse-mixin {
  @include pulse(1s);
}
   </textarea>
  </div>
  <div class="col-1-3">
   <label>Rendering</label>
   <div class="rendering shadow-root"></div>
  </div>
</div>

<div class="row render">
  <h3>Spin</h3>
  <div class="col-1-3">
   <label>HTML</label>
   <textarea class="html">
&lt;span class=&quot;spin-mixin&quot;&gt;this text is spinning&lt;/span&gt;
   </textarea>
  </div>
  <div class="col-1-3">
   <label>CSS</label>
   <textarea class="css">
.spin-mixin {
  @include spin(1s);
}
   </textarea>
  </div>
  <div class="col-1-3">
   <label>Rendering</label>
   <div class="rendering shadow-root"></div>
  </div>
</div>




<div class="row render">
  <h3>Tooltip</h3>
  <div class="col-1-3">
    <label>HTML</label>
    <textarea class="html">
&lt;span class=&quot;tooltip&quot;&gt;
  this text has a tooltip
  &lt;span&gt;this is the tooltip&lt;/span&gt;
&lt;/span&gt;
    </textarea>
  </div>
  <div class="col-1-3">
   <label>CSS</label>
   <textarea class="css">
.tooltip {
  @include tooltip(right);
}
   </textarea>
  </div>
  <div class="col-1-3">
   <label>Rendering</label>
   <div class="rendering shadow-root"></div>
  </div>
</div>


<div class="row render">
  <h3>Table</h3>
  <div class="col-1-3">
   <label>HTML</label>
<textarea class="html">
&lt;table&gt;
  &lt;thead&gt;
    &lt;th&gt;A&lt;/th&gt;
    &lt;th&gt;B&lt;/th&gt;
    &lt;th&gt;C&lt;/th&gt;
    &lt;th&gt;D&lt;/th&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;A&lt;/td&gt;
      &lt;td&gt;B&lt;/td&gt;
      &lt;td&gt;C&lt;/td&gt;
      &lt;td&gt;D&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;A&lt;/td&gt;
      &lt;td&gt;B&lt;/td&gt;
      &lt;td&gt;C&lt;/td&gt;
      &lt;td&gt;D&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
</textarea>
  </div>
  <div class="col-1-3">
   <label>CSS</label>
    <textarea class="css">
/* no css */
    </textarea>
  </div>
  <div class="col-1-3">
   <label>Rendering</label>
   <div class="rendering shadow-root"></div>
  </div>
</div>



<div class="row render">
  <h3>Dropdown</h3>
  <div class="col-1-3">
    <label>HTML</label>
    <textarea class="html">
&lt;button class=&quot;dropdown&quot;&gt;Dropdown &lt;!-- add activate to class open/close it /// with button doesn't work...--&gt;
  &lt;ul class=&quot;options&quot;&gt;
    &lt;li class=&quot;item&quot;&gt;This is 1st link&lt;/li&gt;
    &lt;li class=&quot;item&quot;&gt;This is 2nd link&lt;/li&gt;
    &lt;li class=&quot;item&quot;&gt;This is 3nd link&lt;/li&gt;
    &lt;li class=&quot;item&quot;&gt;This is 4nd link&lt;/li&gt;
    &lt;li class=&quot;item separated&quot;&gt;E&lt;/li&gt;
    &lt;li class=&quot;item&quot;&gt;F&lt;/li&gt;
  &lt;/ul&gt;
&lt;/button&gt;
    </textarea>
  </div>
  <div class="col-1-3">
   <label>CSS</label>
   <textarea class="css">
/* no css */
   </textarea>
  </div>
  <div class="col-1-3">
   <label>Rendering</label>
   <div class="rendering shadow-root"></div>
  </div>
</div>

<div class="row render">
  <h3>Form</h3>
  <div class="col-1-3">
    <label>HTML</label>
    <textarea class="html">
&lt;form&gt;
    &lt;input type=&quot;text&quot; placeholder=&quot;Your name&quot; required /&gt;  
    &lt;input type=&quot;email&quot; placeholder=&quot;Your email&quot; required /&gt;  
    &lt;button class=&quot;button&quot; type=&quot;submit&quot;&gt;SUBSCRIBE&lt;/button&gt;
&lt;/form&gt;
    </textarea>
  </div>
  <div class="col-1-3">
   <label>CSS</label>
   <textarea class="css">
/* no css */
   </textarea>
  </div>
  <div class="col-1-3">
   <label>Rendering</label>
   <div class="rendering shadow-root"></div>
  </div>
</div>

<div class="row render">
  <h3>Icons</h3>
  <div class="col-1-3">
    <label>HTML</label>
    <textarea class="html">
&lt;span class=&quot;icon-example&quot;&gt;x&lt;/span&gt;
&lt;span class=&quot;icon-example2&quot;&gt;&lt;/span&gt;
    </textarea>
  </div>
  <div class="col-1-3">
   <label>CSS</label>
   <textarea class="css">
.icon-example {
  @include icon;
}
.icon-example2 {
  &amp;:after {
    @include icon;
    content: 'v';
  }
}
   </textarea>
  </div>
  <div class="col-1-3">
   <label>Rendering</label>
   <div class="rendering shadow-root"></div>
  </div>
</div>




<!-- <ul class="list">
  <li class="item">A</li>
  <li class="item">B</li>
  <li class="item new">C</li>
  <li>D</li>
</ul>
-->


<!-- <div id="overlay"></div> 
<div id="modal">
  <h2>Modal Title</h2>
  This is a modal
</div>
-->

<!-- <span class="arrow"></span> -->



<script src="bower_components/sass.js/dist/sass.js"></script>
<script id="js" type="text/javascript">
  var sass = new Sass();

  var base = "../../../dist/bourbon";
  var directory = '';
  var files = [
      '_bourbon.scss',
      'settings/_prefixer.scss',
      'settings/_px-to-em.scss',
      'helpers/_gradient-positions-parser.scss',
      'helpers/_linear-positions-parser.scss',
      'helpers/_radial-arg-parser.scss',
      'helpers/_radial-positions-parser.scss',
      'helpers/_render-gradients.scss',
      'helpers/_shape-size-stripper.scss',
      'functions/_color-lightness.scss',
      'functions/_flex-grid.scss',
      'functions/_golden-ratio.scss',
      'functions/_grid-width.scss',
      'functions/_linear-gradient.scss',
      'functions/_modular-scale.scss',
      'functions/_px-to-em.scss',
      'functions/_px-to-rem.scss',
      'functions/_radial-gradient.scss',
      'functions/_strip-units.scss',
      'functions/_tint-shade.scss',
      'functions/_transition-property-name.scss',
      'functions/_unpack.scss',
      'css3/_animation.scss',
      'css3/_appearance.scss',
      'css3/_backface-visibility.scss',
      'css3/_background.scss',
      'css3/_background-image.scss',
      'css3/_border-image.scss',
      'css3/_border-radius.scss',
      'css3/_box-sizing.scss',
      'css3/_calc.scss',
      'css3/_columns.scss',
      'css3/_filter.scss',
      'css3/_flex-box.scss',
      'css3/_font-face.scss',
      'css3/_font-feature-settings.scss',
      'css3/_hyphens.scss',
      'css3/_hidpi-media-query.scss',
      'css3/_image-rendering.scss',
      'css3/_inline-block.scss',
      'css3/_keyframes.scss',
      'css3/_linear-gradient.scss',
      'css3/_perspective.scss',
      'css3/_radial-gradient.scss',
      'css3/_transform.scss',
      'css3/_transition.scss',
      'css3/_user-select.scss',
      'css3/_placeholder.scss',
      'addons/_button.scss',
      'addons/_clearfix.scss',
      'addons/_directional-values.scss',
      'addons/_ellipsis.scss',
      'addons/_font-family.scss',
      'addons/_hide-text.scss',
      'addons/_html5-input-types.scss',
      'addons/_position.scss',
      'addons/_prefixer.scss',
      'addons/_retina-image.scss',
      'addons/_size.scss',
      'addons/_timing-functions.scss',
      'addons/_triangle.scss',
      'addons/_word-wrap.scss',
      '_bourbon-deprecated-upcoming.scss',
    ];
  // download the files immediately
  sass.preloadFiles(base, directory, files, function() { 
    console.log("files loaded");

    var base = '../../../dist/eggshell';
    var directory = '';
    var files = [
      'eggshell.scss',
      '_normalize.scss',
      '_variables.scss',
      'common/_arrow.scss',
      'common/_font.scss',
      'common/_button.scss',
      'common/_tooltip.scss',
      'common/_dropdown.scss',
      'common/_icon.scss',
      'common/_form.scss',
      'common/_pulse.scss',
      'common/_spin.scss',
      'default/_general.scss',
      'default/_buttons.scss',
      'default/_code.scss',
      'default/_dropdown.scss',
      'default/_form.scss',
      'default/_list.scss',
      'default/_loading.scss',
      'default/_notification.scss',
      'default/_overlay.scss',
      'default/_modal.scss',
      'default/_table.scss',
    ];
    // download the files immediately
    sass.preloadFiles(base, directory, files, function() { 
      console.log('files loaded 2');
    });
  });



  var link = document.querySelectorAll('link')[0];
  link.onload = function() {
    console.log(link.sheet);
  };
  
  var rows = document.querySelectorAll('div.row.render');
  [].forEach.call(rows, renderExample);

  document.addEventListener('DOMContentLoaded', function() {
    [].forEach.call(rows, renderExample);
  });


  function renderExample(row) {
    var htmlSource = row.querySelectorAll('textarea.html')[0];
    var styleSource = row.querySelectorAll('textarea.css')[0];

    var CodeMirrorHTMLArea = CodeMirror.fromTextArea(htmlSource, {
      lineNumbers: true,
      mode: "xml",
    });

    var CodeMirrorCSSArea = CodeMirror.fromTextArea(styleSource, {
      lineNumbers: true,
      mode: "css"
    });

    var root = row.querySelectorAll('div.shadow-root')[0];
    var shadowRoot = root.createShadowRoot();

    var styleDest = document.createElement('style'); // make sur no fake whitespace

    styleDest.textContent = "@import './dist/test.css'; " + styleSource.value;

    var rendering = document.createElement('div');
    rendering.innerHTML = htmlSource.textContent;


    shadowRoot.appendChild(styleDest);
    shadowRoot.appendChild(rendering);

    updateRendering(shadowRoot, CodeMirrorHTMLArea, CodeMirrorCSSArea);
    resizeInput(root, CodeMirrorHTMLArea, CodeMirrorCSSArea);

    row.addEventListener('keyup', function() {
      updateRendering(shadowRoot, CodeMirrorHTMLArea, CodeMirrorCSSArea);
      resizeInput(root, CodeMirrorHTMLArea, CodeMirrorCSSArea);
    });
  }

  function updateRendering(root, htmlSource, styleSource) {
    var style = root.querySelectorAll('style')[0];
    var html = root.querySelectorAll('div')[0];

      var scss = "@import \"eggshell\"; " + styleSource.getValue();
      var compiled = sass.compile(scss, function(result) {
        console.log(result);
        if (result.status === 0) {
          style.textContent = result.text;

          html.innerHTML = htmlSource.getValue();
          return;
        } else {
          return ''; // result.message;
        }
      });


  }

  function resizeInput(htmlRendering, htmlSource, styleSource) {
    htmlSource.setSize('100%;', 'auto');
    styleSource.setSize('100%;', 'auto');
    console.log(htmlRendering.offsetHeight);
    var maxHeight = Math.max(htmlSource.display.lastWrapHeight, styleSource.display.lastWrapHeight);

    htmlSource.setSize('100%;', maxHeight);
    styleSource.setSize('100%;', maxHeight);
    htmlRendering.style.height = maxHeight + "px";
  }

</script>


</body>
</html>